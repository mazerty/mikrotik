# change default admin password
/user set admin password=changeme

# a short delay to wait until all interfaces are up
:delay 10s

# a minimal working ethernet configuration over ip
/interface bridge add name=bridge
/interface bridge port add bridge=bridge interface=ether2
/interface bridge port add bridge=bridge interface=ether3
/interface bridge port add bridge=bridge interface=ether4
/interface bridge port add bridge=bridge interface=ether5
/ip dhcp-server network add address=192.168.3.0/24 gateway=192.168.3.1 dns-server=192.168.3.1
/ip pool add name=pool ranges=192.168.3.100-192.168.3.200
/ip dhcp-server add name=dhcp address-pool=pool interface=bridge disabled=no
/ip address add address=192.168.3.1/24 interface=bridge

# firewall rules to protect both router and lan before setting up ether1 and wlan
/ip firewall nat add chain=srcnat action=masquerade out-interface=ether1
/ip firewall filter add chain=input action=accept connection-state=established,related,untracked
/ip firewall filter add chain=input action=accept connection-state=new in-interface=bridge
/ip firewall filter add chain=input action=accept protocol=icmp
/ip firewall filter add chain=input action=log disabled=yes
/ip firewall filter add chain=input action=drop
/ip firewall filter add chain=forward action=fasttrack-connection connection-state=established,related
/ip firewall filter add chain=forward action=accept connection-state=established,related,untracked
/ip firewall filter add chain=forward action=accept connection-state=new in-interface=bridge
/ip firewall filter add chain=forward action=accept connection-state=new in-interface=ether1 connection-nat-state=dstnat
/ip firewall filter add chain=forward action=log disabled=yes
/ip firewall filter add chain=forward action=drop

# some more security restrictions
/ip neighbor discovery-settings set discover-interface-list=none
/tool mac-server set allowed-interface-list=none
/tool mac-server mac-winbox set allowed-interface-list=none

# setting up ether1 and outbound connectivity
/ip route add dst-address=0.0.0.0/0 gateway=192.168.1.254
/ip dns set allow-remote-requests=yes servers=8.8.8.8,8.8.4.4
/ip address add address=192.168.1.3/24 interface=ether1

# wireless configuration
/interface bridge port add bridge=bridge interface=wlan2
/interface wireless security-profiles set default mode=dynamic-keys authentication-types=wpa2-psk wpa2-pre-shared-key=changeme
/interface wireless set wlan2 mode=ap-bridge band=5ghz-a/n/ac wireless-protocol=802.11 channel-width=20/40/80mhz-Ceee frequency=auto ssid=changeme disabled=no
